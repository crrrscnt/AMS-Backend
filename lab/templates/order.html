{% extends 'base.html' %}
{% load static %}

{% block title %}Заявка{% endblock %}

{% block content %}
  <div class="container-upper">
    <table style="width: 100%">
      <tr>
        <td style="width: 70%">
          <h2>Заявка #{{ draft_request.id }}</h2>
        </td>
        <td style="width: 30%; text-align: end">
          <!-- <div>Создана: {{ draft_request.created_at }}<br>Статус: {{ status_name }}<br>
            Космических объектов: {{ num_draft_request }}
            -->
            <div> Космических объектов: {{ num_draft_request }}</div>
        </td>
      </tr>
    </table>
  </div>
  <table class="order-table">
    <thead class="order-table-header">
      <tr>
        <th></th>
        <th></th>
        <th class="order-table-child">
            <table class="order-table-child-table">
              <tr>
                <th style="width: 50%;">АМС</th>
                <th style="width: 50%;">Планируемый старт</th>
              </tr>
            </table>
        </th>
      </tr>
    </thead>
    <tbody>
      {% for object in space_objects %}
        <tr>
          <td style="width: 32px;">.</td>
          <td style="width: 50%" class="order-list-item">
            <table class="order-list-item">
              <tr>
                <td class="order-list-item-img">
                  <img src="{{ object.image_url }}" alt="{{ object.name }}" class="img">
                </td>
                <td class="order-list-item-info">
                  <div>Объект — {{ object.name }}.</div>
                    {% autoescape off %}
                    <div style="font-size: 14px">{{ object.description|truncatewords:10 }}</div>
                    {%  endautoescape %}
                  <!-- <p>Планируемый старт: {{ object.scheduled_at }}</p> -->
                </td>
              </tr>
            </table>
          </td>
          <td class="order-table-child">
            <table class="order-table-child-table">
              <tr>
                <!--<td style="width: 20%;">Dragonfly</td>
                <td style="width: 20%;">2024.09.12</td>-->
                <td style="width: 50%; font-size: 14px">{{ object.uncrewed_spacecraft }}</td>
                <td style="width: 50%; font-size: 14px">{{ object.scheduled_at }}</td>
              </tr>
            </table>
          </td>
        </tr>
      {% endfor %}
    </tbody>
  </table>

  <table>
    <tr>
      <td>
         <!--<div class="button-request-container">
          <form method="post">
            {% csrf_token %}
            <button type="submit" name="form_request">Сформировать заявку</button>
          </form>
        </div> -->
      </td>
      <td> 
        <div class="button-request-container"> <form action="{% url 'order_delete' draft_request.id %}">
          <form method="post">
            {% csrf_token %}
            <button type="submit" name="delete_request">Удалить заявку</button>
          </form>
        </form>
        </div>
      </td>
    </tr>
  </table>
{% endblock %}